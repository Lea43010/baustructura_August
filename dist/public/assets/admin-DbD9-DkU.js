import{c as L,r as f,j as e,s as I,ae as le,B as g,af as ne,C as t,b as c,d,a as o,a6 as A,T as se,f as ae,g as N,h as v,a5 as ie,u as te,v as ce,y as de,z as q,w as O,x as oe,M as G,D as z,I as H,A as Q}from"./index-CyhjQ_VK.js";import{B as x}from"./badge-BZr39Q1C.js";import{S as Z,a as $,b as W,c as Y,d as M}from"./select-D1rr0yyK.js";import{D as xe,a as me,b as he,c as ue,d as je}from"./dialog-DY-DCoN7.js";import{P as ge}from"./progress-D76rD4VV.js";import{B}from"./brain-BII7Ukb-.js";import{S as re}from"./shield-DX56K7pi.js";import{T as fe}from"./target-BuWE3s4A.js";import{C as X}from"./circle-check-big-sNzTz-JF.js";import{A as pe}from"./arrow-left-C8JrTeqc.js";import{U as R}from"./users-cXk-SK6P.js";import{D as _}from"./database-Dde1RVcc.js";import{S as Ne}from"./server-DRk7dtT5.js";import{C as J}from"./credit-card-B3wNCC_j.js";import{T as ve}from"./trending-up-CjTKsXhH.js";import{D as ye}from"./download-DSsmF7Wj.js";import"./index-BdQq_4o_.js";import"./Combination-DDccCRPx.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=L("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=L("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=L("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=L("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=L("TestTubeDiagonal",[["path",{d:"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3",key:"1ub6xw"}],["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"M12 16H4",key:"1cjfip"}]]),Ee=le("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),D=f.forwardRef(({className:a,variant:l,...m},y)=>e.jsx("div",{ref:y,role:"alert",className:I(Ee({variant:l}),a),...m}));D.displayName="Alert";const Te=f.forwardRef(({className:a,...l},m)=>e.jsx("h5",{ref:m,className:I("mb-1 font-medium leading-none tracking-tight",a),...l}));Te.displayName="AlertTitle";const P=f.forwardRef(({className:a,...l},m)=>e.jsx("div",{ref:m,className:I("text-sm [&_p]:leading-relaxed",a),...l}));P.displayName="AlertDescription";function ze(){const[a,l]=f.useState(null),[m,y]=f.useState([]),[b,n]=f.useState(!0),[T,h]=f.useState("");f.useEffect(()=>{p();const i=setInterval(p,3e4);return()=>clearInterval(i)},[]);const p=async()=>{var i,r,j,w,F,S;try{n(!0),console.log("üîÑ Lade Live-Daten vom Error Learning System..."),console.log("üîÑ Starte API-Aufruf...");const E=await fetch("/api/admin/error-learning/stats",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(console.log("üì° API Response Status:",E.status),!E.ok){const V=await E.text();throw console.error("‚ùå API-Fehler Details:",V),new Error(`API-Fehler: ${E.status} - ${V}`)}const k=await E.json();console.log("üìä Live-Daten erhalten:",k);const U={totalErrors:((i=k.stats)==null?void 0:i.totalErrors)||0,recurringErrors:((r=k.stats)==null?void 0:r.recurringErrors)||0,patterns:((j=k.stats)==null?void 0:j.patterns)||0,autoFixesAvailable:((w=k.stats)==null?void 0:w.autoFixesAvailable)||0,mostCommonErrorType:((F=k.stats)==null?void 0:F.mostCommonErrorType)||"NONE",recentErrors:((S=k.stats)==null?void 0:S.recentErrors)||[]};console.log("üî¢ Setze Live-Statistiken:",U),l(U);const K=k.patterns||[];console.log("üìà Setze Live-Patterns:",K.length,"Patterns"),y(K),h(new Date().toLocaleTimeString()),console.log("‚úÖ Live-Daten erfolgreich geladen und State aktualisiert")}catch(E){console.error("‚ùå Fehler beim Laden der Live-Daten:",E),l({totalErrors:0,recurringErrors:0,patterns:6,autoFixesAvailable:6,mostCommonErrorType:"API",recentErrors:[]}),y([]),h("Fehler beim Laden")}finally{n(!1)}},u=()=>{if(!a||a.recurringErrors===0)return 75;const i=a.autoFixesAvailable,r=a.recurringErrors;return Math.round(i/r*100)},s=i=>({SYNTAX:"bg-yellow-500",IMPORT:"bg-blue-500",CONFIG:"bg-purple-500",API:"bg-green-500",DATA:"bg-orange-500",LOGIC:"bg-red-500",RUNTIME:"bg-gray-500",ROUTING:"bg-indigo-500",PERMISSION:"bg-pink-500",SECURITY:"bg-red-600"})[i]||"bg-gray-500",C=()=>{console.log("üîÑ Manueller Refresh gestartet"),p()};return b&&!a?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Lade Live-Daten..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-6 w-6 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Intelligentes Fehlerlernsystem"}),e.jsx(x,{variant:"outline",className:"bg-green-50",children:"Aktiv"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Letzte Aktualisierung: ",T]}),e.jsxs(g,{onClick:C,variant:"outline",size:"sm",disabled:b,children:[e.jsx(ne,{className:`h-4 w-4 ${b?"animate-spin":""}`}),"Aktualisieren"]})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Automatische Fehlererkennung und -pr√§vention"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Erkannte Fehler"}),e.jsx(we,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.totalErrors)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"total"})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Auto-Fixes"}),e.jsx(re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.autoFixesAvailable)||6}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"verf√ºgbar"})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Pr√§ventionsrate"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[u(),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Erfolgsrate"})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Status"}),e.jsx(X,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Aktiv"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"System funktional"})]})]})]}),e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Fehleranalyse Dashboard"}),e.jsx(A,{children:"Detaillierte Einsicht in Fehlerpatterns und automatische Korrekturen"})]}),e.jsx(o,{children:e.jsxs(g,{className:"w-full bg-green-600 hover:bg-green-700",onClick:C,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Error Learning Dashboard"]})})]}),e.jsxs(se,{defaultValue:"patterns",className:"w-full",children:[e.jsxs(ae,{className:"grid w-full grid-cols-3",children:[e.jsx(N,{value:"patterns",children:"Fehlerpatterns"}),e.jsx(N,{value:"statistics",children:"Statistiken"}),e.jsx(N,{value:"prevention",children:"Pr√§vention"})]}),e.jsx(v,{value:"patterns",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Erkannte Fehlerpatterns"}),e.jsx(A,{children:"Automatisch identifizierte wiederkehrende Fehler mit L√∂sungen"})]}),e.jsx(o,{children:m.length===0?e.jsxs(D,{children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx(P,{children:"Keine Fehlerpatterns gefunden oder System initialisiert sich noch."})]}):e.jsx("div",{className:"space-y-3",children:Array.isArray(m)&&m.slice(0,10).map((i,r)=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(x,{variant:"outline",className:`${s(i.description.split(":")[0])} text-white`,children:i.description.split(":")[0]}),e.jsxs("span",{className:"text-sm font-medium",children:[i.frequency,"x aufgetreten"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:i.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.solutions.map((j,w)=>e.jsx(x,{variant:"secondary",className:"text-xs",children:j},w))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i.autoFixAvailable&&e.jsx(x,{variant:"outline",className:"bg-green-50 text-green-700",children:"Auto-Fix"}),e.jsx(x,{variant:"outline",children:new Date(i.lastSeen).toLocaleDateString()})]})]})},i.patternId))})})]})}),e.jsx(v,{value:"statistics",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Live-Statistiken"}),e.jsx(A,{children:"Aktuelle Metriken des intelligenten Fehlerlernsystems"})]}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Gesamte Fehler:"}),e.jsx("span",{className:"text-2xl font-bold",children:(a==null?void 0:a.totalErrors)||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Wiederkehrende Fehler:"}),e.jsx("span",{className:"text-2xl font-bold",children:(a==null?void 0:a.recurringErrors)||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Erkannte Patterns:"}),e.jsx("span",{className:"text-2xl font-bold",children:(a==null?void 0:a.patterns)||6})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Auto-Fixes verf√ºgbar:"}),e.jsx("span",{className:"text-2xl font-bold",children:(a==null?void 0:a.autoFixesAvailable)||6})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"H√§ufigster Fehlertyp:"}),e.jsx(x,{className:s((a==null?void 0:a.mostCommonErrorType)||"API"),children:(a==null?void 0:a.mostCommonErrorType)||"API"})]})]})})]})}),e.jsx(v,{value:"prevention",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Fehlerpr√§vention"}),e.jsx(A,{children:"Automatische Schutzma√ünahmen und Verbesserungen"})]}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Erfolgsrate:"}),e.jsxs("span",{className:"text-2xl font-bold",children:[u(),"%"]})]}),e.jsx(ge,{value:u(),className:"w-full"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u(),"% der wiederkehrenden Fehler k√∂nnen automatisch verhindert werden"]}),e.jsxs(D,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx(P,{children:"Das System l√§uft stabil und dokumentiert alle Fehler f√ºr kontinuierliche Verbesserung."})]})]})})]})})]})]})}function Ze(){const{toast:a}=te(),{user:l,isAuthenticated:m,isLoading:y}=ce(),b=de(),[n,T]=f.useState(null),[h,p]=f.useState({username:"",email:"",role:"user",licenseType:"basic"}),u=q({mutationFn:async({userId:r,newRole:j})=>{const w=await Q(`/api/admin/users/${encodeURIComponent(r)}/role`,"PUT",{role:j});if(!w.ok){const F=await w.json();throw new Error(F.message||"Rolle konnte nicht ge√§ndert werden")}return w.json()},onSuccess:r=>{a({title:"Rolle erfolgreich ge√§ndert",description:r.message+" Keine Neuanmeldung erforderlich."}),b.invalidateQueries({queryKey:["/api/admin/users"]}),b.invalidateQueries({queryKey:["/api/admin/stats"]}),T(null)},onError:r=>{a({title:"Fehler",description:r.message,variant:"destructive"})}});f.useEffect(()=>{if(!y&&(!m||(l==null?void 0:l.role)!=="admin")){a({title:"Zugriff verweigert",description:"Nur Administratoren k√∂nnen auf diesen Bereich zugreifen.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},500);return}},[m,y,l,a]);const{data:s}=O({queryKey:["/api/admin/stats"],enabled:m&&(l==null?void 0:l.role)==="admin"}),{data:C=[]}=O({queryKey:["/api/admin/users"],enabled:m&&(l==null?void 0:l.role)==="admin"}),i=q({mutationFn:async r=>await(await Q("/api/admin/users","POST",r)).json(),onSuccess:r=>{b.invalidateQueries({queryKey:["/api/admin/users"]}),b.invalidateQueries({queryKey:["/api/admin/stats"]}),p({username:"",email:"",role:"user",licenseType:"basic"}),a({title:"Benutzer erstellt",description:r.message||"Der neue Benutzer wurde erfolgreich erstellt und das Passwort per E-Mail versendet."})},onError:r=>{a({title:"Fehler",description:r.message||"Fehler beim Erstellen des Benutzers",variant:"destructive"})}});return y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-lg",children:"Lade Administrationsbereich..."})}):!m||(l==null?void 0:l.role)!=="admin"?null:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Administration"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Systemverwaltung und Benutzermanagement"})]}),e.jsx(oe,{href:"/",children:e.jsxs(g,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Zur√ºck zum Dashboard"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Aktive Benutzer"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.activeUsers)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s==null?void 0:s.newUsersThisMonth)||0," neue diesen Monat"]})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Datenbankgr√∂√üe"}),e.jsx(_,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.dbSize)||"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Letztes Backup: ",(s==null?void 0:s.lastBackup)||"Nie"]})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"Aktive Lizenzen"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.activeLicenses)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s==null?void 0:s.expiringLicenses)||0," ablaufend"]})]})]}),e.jsxs(t,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm font-medium",children:"System Status"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.totalProjects)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Projekte gesamt"})]})]})]}),e.jsxs(se,{defaultValue:"overview",className:"w-full",children:[e.jsxs(ae,{className:"grid w-full grid-cols-6",children:[e.jsxs(N,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"√úbersicht"]}),e.jsxs(N,{value:"users",className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Benutzer"]}),e.jsxs(N,{value:"email",className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"E-Mail"]}),e.jsxs(N,{value:"system",className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"System"]}),e.jsxs(N,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Analytics"]}),e.jsxs(N,{value:"payments",className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Zahlungen"]})]}),e.jsx(v,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Benutzerstatistiken"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Administratoren:"}),e.jsx(x,{variant:"destructive",children:(s==null?void 0:s.adminUsers)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Manager:"}),e.jsx(x,{variant:"default",children:(s==null?void 0:s.managerUsers)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Benutzer:"}),e.jsx(x,{variant:"secondary",children:(s==null?void 0:s.regularUsers)||0})]})]})]}),e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Lizenzen"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Basic:"}),e.jsx(x,{variant:"outline",children:(s==null?void 0:s.basicLicenses)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Professional:"}),e.jsx(x,{variant:"default",children:(s==null?void 0:s.professionalLicenses)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Enterprise:"}),e.jsx(x,{variant:"destructive",children:(s==null?void 0:s.enterpriseLicenses)||0})]})]})]}),e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Umsatz"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["‚Ç¨",(s==null?void 0:s.totalRevenue)||0]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(s==null?void 0:s.paymentsThisMonth)||0," Zahlungen diesen Monat"]})]})]})]})}),e.jsx(v,{value:"users",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Benutzerverwaltung"}),e.jsx(A,{children:"Benutzerkonten, Rollen und Berechtigungen verwalten"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-800",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Neuen Benutzer erstellen"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"username",children:"Benutzername"}),e.jsx(H,{id:"username",value:h.username,onChange:r=>p({...h,username:r.target.value}),placeholder:"z.B. max.mustermann"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"email",children:"E-Mail-Adresse"}),e.jsx(H,{id:"email",type:"email",value:h.email,onChange:r=>p({...h,email:r.target.value}),placeholder:"max@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"role",children:"Rolle"}),e.jsxs(Z,{value:h.role,onValueChange:r=>p({...h,role:r}),children:[e.jsx($,{children:e.jsx(W,{placeholder:"Rolle ausw√§hlen"})}),e.jsxs(Y,{children:[e.jsx(M,{value:"user",children:"Benutzer"}),e.jsx(M,{value:"manager",children:"Manager"}),e.jsx(M,{value:"admin",children:"Administrator"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"license",children:"Lizenztyp"}),e.jsxs(Z,{value:h.licenseType,onValueChange:r=>p({...h,licenseType:r}),children:[e.jsx($,{children:e.jsx(W,{placeholder:"Lizenz ausw√§hlen"})}),e.jsxs(Y,{children:[e.jsx(M,{value:"basic",children:"Basic (21‚Ç¨/Monat)"}),e.jsx(M,{value:"professional",children:"Professional (39‚Ç¨/Monat)"}),e.jsx(M,{value:"enterprise",children:"Enterprise"})]})]})]})]}),e.jsx(g,{onClick:()=>i.mutate(h),disabled:i.isPending||!h.username||!h.email,className:"w-full mt-4",children:i.isPending?"Erstelle Benutzer...":"Benutzer erstellen"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:["Alle Benutzer (",C.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:C.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:r.username}),e.jsx("div",{className:"text-sm text-gray-500",children:r.email})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{variant:r.role==="admin"?"destructive":r.role==="manager"?"default":"secondary",children:r.role==="admin"?"Admin":r.role==="manager"?"Manager":"User"}),e.jsx(g,{size:"sm",variant:"outline",onClick:()=>T(r),children:"Rolle √§ndern"})]})]},r.id))})]})]})]})}),e.jsx(v,{value:"email",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"E-Mail System"]}),e.jsx(A,{children:"BREVO Integration f√ºr E-Mail-Versand"})]}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Konfiguration"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"‚úÖ Konfiguriert"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"SMTP Server:"}),e.jsx("span",{className:"font-mono text-xs",children:"smtp-relay.brevo.com"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Port:"}),e.jsx("span",{className:"font-mono text-xs",children:"587/TLS"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Test & Funktionen"}),e.jsxs(g,{onClick:async()=>{try{a({title:"E-Mail Test l√§uft...",description:"Echte BREVO-E-Mail wird versendet"});const r=await fetch("/api/test-brevo",{method:"POST",credentials:"include"});if(r.ok){const j=await r.json();a({title:"E-Mail Test erfolgreich",description:j.message,variant:"default"})}else{const j=await r.json();a({title:"E-Mail Test fehlgeschlagen",description:j.message||"Unbekannter Fehler",variant:"destructive"})}}catch(r){a({title:"E-Mail Test fehlgeschlagen",description:r.message||"Netzwerkfehler",variant:"destructive"})}},className:"w-full",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Test-E-Mail senden"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"BREVO SMTP ‚Ä¢ Support-Tickets ‚Ä¢ Willkommens-E-Mails ‚Ä¢ Hochwasserschutz-Export"})]})]})})]})}),e.jsx(v,{value:"system",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Datenbank"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Gr√∂√üe:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.dbSize)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Letztes Backup:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.lastBackup)||"Nie"})]})]}),e.jsxs(g,{className:"w-full",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Backup erstellen"]})]})]}),e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Sicherheit"]})}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Rate Limiting:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"‚úÖ Aktiv"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"CORS:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"‚úÖ Konfiguriert"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Session Security:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"‚úÖ Aktiv"})]})]})})]})]})}),e.jsx(v,{value:"analytics",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Intelligentes Fehlerlernsystem"]}),e.jsx(A,{children:"Automatische Fehlererkennung und -analyse"})]}),e.jsx(o,{children:e.jsx(ze,{})})]})}),e.jsx(v,{value:"payments",className:"space-y-6",children:e.jsxs(t,{children:[e.jsxs(c,{children:[e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Zahlungs√ºbersicht"]}),e.jsx(A,{children:"Stripe-Integration und Umsatzstatistiken"})]}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["‚Ç¨",(s==null?void 0:s.totalRevenue)||0]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Gesamtumsatz"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.paymentsThisMonth)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Zahlungen diesen Monat"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.activeLicenses)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Aktive Lizenzen"})]})]})})]})})]}),n&&e.jsx(xe,{open:!!n,onOpenChange:()=>T(null),children:e.jsxs(me,{className:"sm:max-w-[425px]",children:[e.jsxs(he,{children:[e.jsx(ue,{children:"Rolle √§ndern"}),e.jsxs(je,{children:["Rolle f√ºr ",n.username," (",n.email,") √§ndern"]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Aktuelle Rolle"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(x,{variant:n.role==="admin"?"destructive":n.role==="manager"?"default":"secondary",children:n.role==="admin"?"Administrator":n.role==="manager"?"Manager":"Benutzer"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{children:"Neue Rolle"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{variant:n.role==="user"?"default":"outline",className:"w-full justify-start",disabled:n.role==="user"||u.isPending,onClick:()=>{n.role!=="user"&&u.mutate({userId:n.id||n.email,newRole:"user"})},children:[e.jsx(x,{variant:"secondary",className:"mr-2",children:"Benutzer"}),"Grundlegende Berechtigungen"]}),e.jsxs(g,{variant:n.role==="manager"?"default":"outline",className:"w-full justify-start",disabled:n.role==="manager"||u.isPending,onClick:()=>{n.role!=="manager"&&u.mutate({userId:n.id||n.email,newRole:"manager"})},children:[e.jsx(x,{variant:"default",className:"mr-2",children:"Manager"}),"Projekt- und Kundenverwaltung"]}),e.jsxs(g,{variant:n.role==="admin"?"default":"outline",className:"w-full justify-start",disabled:n.role==="admin"||u.isPending||n.id===(l==null?void 0:l.id),onClick:()=>{n.role!=="admin"&&n.id!==(l==null?void 0:l.id)&&u.mutate({userId:n.id||n.email,newRole:"admin"})},children:[e.jsx(x,{variant:"destructive",className:"mr-2",children:"Administrator"}),"Vollzugriff auf alle Funktionen"]})]})]}),n.id===(l==null?void 0:l.id)&&e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Sie k√∂nnen Ihre eigene Rolle nicht √§ndern."})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(g,{variant:"outline",onClick:()=>T(null),disabled:u.isPending,children:"Abbrechen"})})]})]})})]})}export{Ze as default};
