import{c as me,e as xe,u as oe,r as S,j as e,B as t,C as n,a as m,a5 as B,T as ue,f as ge,g as N,D as l,ac as g,M as Z,I as v,h as w,b as D,d as _,A as K,ad as je}from"./index-CyhjQ_VK.js";import{B as x}from"./badge-BZr39Q1C.js";import{T as W}from"./textarea-BuGvpmpE.js";import{S as E,a as A,b as T,c as z,d as o}from"./select-D1rr0yyK.js";import{D as M,f as R,a as I,b as $,c as H}from"./dialog-DY-DCoN7.js";import{P as pe}from"./page-header-CfMEZ_QD.js";import{A as fe}from"./app-layout-BmSq0-fU.js";import{A as be}from"./arrow-left-C8JrTeqc.js";import{S as Ne}from"./shield-DX56K7pi.js";import{F as j}from"./file-text-BJnhxmUe.js";import{S as U}from"./settings-RhnSVDqX.js";import{U as q}from"./users-cXk-SK6P.js";import{P as G}from"./plus-D7MkCcQh.js";import{D as ve}from"./download-DSsmF7Wj.js";import{S as we}from"./search-_i4Cbbz2.js";import{S as O}from"./square-pen-DsHIieuw.js";import{M as J}from"./map-pin-LITRY39W.js";import{C as ye}from"./camera-BUbOfpe-.js";import{C as ke}from"./calendar-DrNP2I0J.js";import{C as Ce}from"./circle-check-big-sNzTz-JF.js";import{T as V}from"./trash-2-Bnck2P-r.js";import"./index-BdQq_4o_.js";import"./Combination-DDccCRPx.js";import"./building-2-C2UTDJSA.js";import"./mobile-nav-Cu-R2ZoU.js";import"./mic-COeeLFIv.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=me("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);function es(){const[,p]=xe(),{toast:i}=oe(),[Q,X]=S.useState("checklists"),[Y,ee]=S.useState(""),[se,y]=S.useState(!1),[f,b]=S.useState({titel:"",typ:"hochwasser",pegelstand:"",beschreibung:""}),te=async()=>{try{const s=u[0],a={checklist:s,schieber:F,schaeden:P,wachen:L,exportedAt:new Date().toLocaleString("de-DE"),exportedBy:"Aktueller Benutzer"},r=await(await fetch("/api/flood-protection/export-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).blob(),h=window.URL.createObjectURL(r),d=document.createElement("a");d.href=h,d.download=`Hochwasserschutz-Checkliste-${s.titel}-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(h),i({title:"PDF erstellt",description:"Die Checkliste wurde erfolgreich als PDF exportiert."})}catch{i({title:"Export fehlgeschlagen",description:"PDF konnte nicht erstellt werden. Versuchen Sie es erneut.",variant:"destructive"})}},ae=async()=>{var s,a,c;try{const r=(s=document.getElementById("email-to"))==null?void 0:s.value,h=(a=document.getElementById("email-subject"))==null?void 0:a.value,d=(c=document.getElementById("email-message"))==null?void 0:c.value;if(!r){i({title:"E-Mail-Adresse erforderlich",description:"Bitte geben Sie eine Empfänger-E-Mail-Adresse ein.",variant:"destructive"});return}const he=u[0];await K("POST","/api/flood-protection/send-email",{to:r,subject:h,message:d,checklist:he,schieber:F,schaeden:P,wachen:L,includePdf:!0}),i({title:"E-Mail gesendet",description:`Die Checkliste wurde erfolgreich an ${r} gesendet.`})}catch{i({title:"E-Mail-Versand fehlgeschlagen",description:"E-Mail konnte nicht gesendet werden. Prüfen Sie die E-Mail-Adresse.",variant:"destructive"})}},le=async()=>{try{const{titel:s,typ:a,pegelstand:c,beschreibung:r}=f;if(console.log("Erstelle Checkliste mit Daten:",{titel:s,typ:a,pegelstand:c,beschreibung:r}),!s||!c){i({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}const h=await K("POST","/api/flood/create-checklist",{titel:s,typ:a,beginn_pegelstand_cm:parseInt(c),beschreibung:r});console.log("API Response:",h.status,h.statusText);const d=await h.json();console.log("API Result:",d),i({title:"Erfolgreich",description:`Checkliste "${s}" wurde erstellt.`}),y(!1),b({titel:"",typ:"hochwasser",pegelstand:"",beschreibung:""}),je.invalidateQueries({queryKey:["/api/flood/checklists"]})}catch(s){console.error("Fehler beim Erstellen der Checkliste:",s),i({title:"Fehler",description:`Fehler beim Erstellen der Checkliste: ${s instanceof Error?s.message:"Unbekannter Fehler"}`,variant:"destructive"})}},ie=s=>{p(`/flood-protection/checklist/${s}`)},re=async(s,a)=>{if(window.confirm(`Möchten Sie die Checkliste "${a}" wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.`))try{await fetch(`/api/flood/checklists/${s}`,{method:"DELETE"}),i({title:"Checkliste gelöscht",description:`"${a}" wurde erfolgreich gelöscht.`})}catch{i({title:"Fehler",description:"Fehler beim Löschen der Checkliste.",variant:"destructive"})}},ne=async()=>{if(!(!window.confirm(`Möchten Sie wirklich ALLE Checklisten löschen? Diese Aktion kann nicht rückgängig gemacht werden.

Alle Aufgaben, Prüfungen und Dokumentationen gehen verloren.`)||!window.confirm('Sind Sie sich absolut sicher? Geben Sie zur Bestätigung "ALLE LÖSCHEN" ein.')))try{await fetch("/api/flood/checklists/delete-all",{method:"DELETE"}),i({title:"Alle Checklisten gelöscht",description:"Alle Checklisten wurden erfolgreich gelöscht."})}catch{i({title:"Fehler",description:"Fehler beim Löschen der Checklisten.",variant:"destructive"})}},ce=async s=>{try{await fetch("/api/flood/checklists/duplicate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checklistId:s})}),i({title:"Checkliste dupliziert",description:"Eine Kopie der Checkliste wurde erstellt."})}catch{i({title:"Fehler",description:"Fehler beim Duplizieren der Checkliste.",variant:"destructive"})}},u=[{id:"1",titel:"Hochwasserereignis Mai 2025 (Beispiel)",typ:"hochwasser",status:"in_bearbeitung",erstellt_am:"2025-05-15T08:00:00Z",erstellt_von:"Thomas Müller",beginn_pegelstand_cm:245,fortschritt:68,aufgaben_gesamt:11,aufgaben_erledigt:7},{id:"2",titel:"Präventive Kontrolle Deichanlage (Beispiel)",typ:"kontrolle",status:"offen",erstellt_am:"2025-06-01T14:15:00Z",erstellt_von:"Dr. Klein",beginn_pegelstand_cm:150,fortschritt:33,aufgaben_gesamt:6,aufgaben_erledigt:2}],F=[{id:1,nummer:1,bezeichnung:"Absperrschieber DN 300 (Beispiel)",lage:"Lohr km 1,470, Nähe Kupfermühle",beschreibung:"Absperrschieber DN 300 mit Festspindel bis unter die Schachtdeckelunterkante",status:"funktionsfähig",letzte_pruefung:"2025-06-25",koordinaten_lat:49.7962,koordinaten_lng:9.9332},{id:2,nummer:2,bezeichnung:"Absperrschütz bei ehem. Grundwehr (Beispiel)",lage:"Lohr km 1,320",beschreibung:"Absperrschütz bei ehem. Grundwehr",status:"wartung_erforderlich",letzte_pruefung:"2025-06-20",koordinaten_lat:49.7951,koordinaten_lng:9.9318},{id:3,nummer:3,bezeichnung:"Absperrschieber DN 1800 (Beispiel)",lage:"Mutterbach, Überführungsbauwerk Nähe Parkplatz Augenklinik, Grundstück Weierich",beschreibung:"Absperrschieber DN1800 im Mutterbach mit aufgesetztem Schieber DN 300 (Nr.4)",status:"funktionsfähig",letzte_pruefung:"2025-06-26",koordinaten_lat:49.7945,koordinaten_lng:9.9305}],P=[{id:"1",absperrschieber_nummer:1,problem_beschreibung:"Festsitzender Deckel bei Schieber Nr. 1",status:"behoben",prioritaet:2,gemeldet_am:"2025-06-25T09:15:00Z",gemeldet_von:"Klaus Werner",massnahme:"Mit Vorschlaghammer den Schacht freischlagen"},{id:"2",absperrschieber_nummer:2,problem_beschreibung:"Kein Zulauf in Mühlgraben bei Schieber Nr. 2",status:"in_bearbeitung",prioritaet:1,gemeldet_am:"2025-06-28T11:30:00Z",gemeldet_von:"Anna Schmidt",massnahme:"Prüfen ob Schieber geschlossen ist >> öffnen; Rechen am Zulaufrohr in Lohr räumen"}],L=[{id:"1",name:"Klaus Werner",telefon:"0171-1234567",schicht_beginn:"2025-06-29T06:00:00Z",schicht_ende:"2025-06-29T18:00:00Z",bereich:"Deichabschnitt A (km 0,0 - 2,5)",bemerkung:"Erfahrener Deichwächter"},{id:"2",name:"Anna Schmidt",telefon:"0172-9876543",schicht_beginn:"2025-06-29T18:00:00Z",schicht_ende:"2025-06-30T06:00:00Z",bereich:"Deichabschnitt B (km 2,5 - 5,0)",bemerkung:"Nachtschicht"}],k=s=>{switch(s){case"offen":return"bg-blue-500";case"in_bearbeitung":return"bg-orange-500";case"abgeschlossen":return"bg-green-500";case"funktionsfähig":return"bg-green-500";case"wartung_erforderlich":return"bg-orange-500";case"defekt":return"bg-red-500";case"behoben":return"bg-green-500";default:return"bg-gray-500"}},C=s=>{switch(s){case"offen":return"Offen";case"in_bearbeitung":return"In Bearbeitung";case"abgeschlossen":return"Abgeschlossen";case"funktionsfähig":return"Funktionsfähig";case"wartung_erforderlich":return"Wartung erforderlich";case"defekt":return"Defekt";case"behoben":return"Behoben";default:return s}},de=s=>{switch(s){case 1:return"text-red-600 bg-red-100";case 2:return"text-orange-600 bg-orange-100";case 3:return"text-yellow-600 bg-yellow-100";case 4:return"text-blue-600 bg-blue-100";case 5:return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return e.jsxs(fe,{children:[e.jsx(pe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>p("/"),className:"flex items-center p-2",children:[e.jsx(be,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Zurück zum Dashboard"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ne,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600"}),e.jsx("h1",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:"Hochwasserschutz"})]})]}),e.jsxs(t,{variant:"outline",onClick:()=>p("/hochwasser-anleitung"),className:"flex items-center space-x-2",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{children:"Wartungsanleitung"})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:[e.jsx(n,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Checklisten"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"2"}),e.jsx("p",{className:"text-xs text-gray-500",children:"aktiv"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(n,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Schieber"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"5"}),e.jsx("p",{className:"text-xs text-gray-500",children:"bereit"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(n,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Schäden"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:"0"}),e.jsx("p",{className:"text-xs text-gray-500",children:"gemeldet"})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(B,{className:"h-6 w-6 text-orange-600"})})]})})}),e.jsx(n,{children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Wachen"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"3"}),e.jsx("p",{className:"text-xs text-gray-500",children:"besetzt"})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"h-6 w-6 text-purple-600"})})]})})})]}),e.jsxs(ue,{value:Q,onValueChange:X,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ge,{className:"grid w-full max-w-lg grid-cols-5",children:[e.jsx(N,{value:"checklists",children:"Checklisten"}),e.jsx(N,{value:"schieber",children:"Schieber"}),e.jsx(N,{value:"schaden",children:"Schäden"}),e.jsx(N,{value:"wachen",children:"Wachen"}),e.jsx(N,{value:"verwalten",children:"Verwalten"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(t,{onClick:()=>y(!0),className:"flex-1 sm:flex-none",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Neue Checkliste"}),e.jsx("span",{className:"sm:hidden",children:"Neu"})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(t,{variant:"outline",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"PDF Export"]})}),e.jsxs(I,{className:"max-w-lg",children:[e.jsx($,{children:e.jsx(H,{children:"Checkliste als PDF exportieren"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Checkliste auswählen:"}),e.jsxs(E,{children:[e.jsx(A,{children:e.jsx(T,{placeholder:"Wählen Sie eine Checkliste"})}),e.jsx(z,{children:u.map(s=>e.jsxs(o,{value:s.id,children:[s.titel," (",s.typ,")"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"PDF-Inhalt:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"include-basic",defaultChecked:!0}),e.jsx(l,{htmlFor:"include-basic",children:"Grunddaten der Checkliste"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"include-tasks",defaultChecked:!0}),e.jsx(l,{htmlFor:"include-tasks",children:"Alle Aufgaben und Status"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"include-schieber",defaultChecked:!0}),e.jsx(l,{htmlFor:"include-schieber",children:"Absperrschieber-Status"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"include-damages"}),e.jsx(l,{htmlFor:"include-damages",children:"Schadensfälle"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"include-guards"}),e.jsx(l,{htmlFor:"include-guards",children:"Deichwachen"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",children:"Abbrechen"}),e.jsxs(t,{onClick:()=>te(),children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"PDF erstellen"]})]})]})]})]}),e.jsxs(M,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(t,{variant:"outline",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"E-Mail Export"]})}),e.jsxs(I,{className:"max-w-lg",children:[e.jsx($,{children:e.jsx(H,{children:"Checkliste per E-Mail versenden"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Checkliste auswählen:"}),e.jsxs(E,{children:[e.jsx(A,{children:e.jsx(T,{placeholder:"Wählen Sie eine Checkliste"})}),e.jsx(z,{children:u.map(s=>e.jsxs(o,{value:s.id,children:[s.titel," (",s.typ,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email-to",children:"Empfänger E-Mail:"}),e.jsx(v,{id:"email-to",type:"email",placeholder:"empfaenger@example.com"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email-subject",children:"Betreff:"}),e.jsx(v,{id:"email-subject",defaultValue:"Hochwasserschutz-Checkliste",placeholder:"E-Mail Betreff"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email-message",children:"Nachricht:"}),e.jsx(W,{id:"email-message",rows:4,defaultValue:"Anbei erhalten Sie die angeforderte Hochwasserschutz-Checkliste als PDF-Dokument.",placeholder:"Ihre Nachricht..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Als Anhang senden:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"email-pdf",defaultChecked:!0}),e.jsx(l,{htmlFor:"email-pdf",children:"PDF-Datei"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",children:"Abbrechen"}),e.jsxs(t,{onClick:()=>ae(),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"E-Mail senden"]})]})]})]})]})]})]}),e.jsxs(w,{value:"checklists",className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(v,{placeholder:"Checklisten durchsuchen...",value:Y,onChange:s=>ee(s.target.value),className:"pl-10 h-11"})]}),e.jsxs(E,{defaultValue:"alle",children:[e.jsx(A,{className:"h-11 sm:w-48",children:e.jsx(T,{placeholder:"Status filtern"})}),e.jsxs(z,{children:[e.jsx(o,{value:"alle",children:"Alle Status"}),e.jsx(o,{value:"offen",children:"Offen"}),e.jsx(o,{value:"in_bearbeitung",children:"In Bearbeitung"}),e.jsx(o,{value:"abgeschlossen",children:"Abgeschlossen"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:u.map(s=>e.jsxs(n,{className:"hover:shadow-md transition-shadow",children:[e.jsx(D,{className:"pb-3 sm:pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(_,{className:"text-base sm:text-lg truncate",children:s.titel}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:["Erstellt: ",new Date(s.erstellt_am).toLocaleDateString("de-DE")]})]}),e.jsx(x,{className:`${k(s.status)} text-white text-xs ml-2 flex-shrink-0`,children:C(s.status)})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Typ"}),e.jsx(x,{variant:"outline",children:s.typ==="hochwasser"?"Hochwasser":s.typ==="kontrolle"?"Kontrolle":"Übung"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Erstellt von"}),e.jsx("span",{className:"font-medium",children:s.erstellt_von})]}),s.beginn_pegelstand_cm&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pegelstand"}),e.jsxs("span",{className:"font-medium",children:[s.beginn_pegelstand_cm," cm"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Aufgaben"}),e.jsxs("span",{className:"font-medium",children:[s.aufgaben_erledigt,"/",s.aufgaben_gesamt]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${s.fortschritt}%`}})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>p(`/flood-protection/checklist/${s.id}`),children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"Öffnen"]}),s.status!=="abgeschlossen"&&e.jsxs(t,{size:"sm",className:"flex-1",onClick:()=>ie(s.id),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})})]},s.id))})]}),e.jsx(w,{value:"schieber",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(s=>e.jsxs(n,{className:"hover:shadow-md transition-shadow",children:[e.jsx(D,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs(_,{className:"text-lg",children:["Schieber Nr. ",s.nummer]}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:s.bezeichnung})]}),e.jsx(x,{className:`${k(s.status)} text-white`,children:C(s.status)})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(J,{className:"h-4 w-4 text-gray-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.lage})]}),e.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:s.beschreibung}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Letzte Prüfung"}),e.jsx("span",{className:"font-medium",children:new Date(s.letzte_pruefung).toLocaleDateString("de-DE")})]}),s.koordinaten_lat&&s.koordinaten_lng&&e.jsxs("div",{className:"text-xs text-gray-500",children:["GPS: ",s.koordinaten_lat.toFixed(4),", ",s.koordinaten_lng.toFixed(4)]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Prüfen"]}),e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Schaden"]})]})]})})]},s.id))})}),e.jsx(w,{value:"schaden",className:"space-y-6",children:e.jsx("div",{className:"space-y-4",children:P.map(s=>e.jsxs(n,{className:"hover:shadow-md transition-shadow",children:[e.jsx(D,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(_,{className:"text-lg",children:s.problem_beschreibung}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs("span",{children:["Schieber Nr. ",s.absperrschieber_nummer]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(s.gemeldet_am).toLocaleDateString("de-DE")})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx("span",{children:s.gemeldet_von})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(x,{className:`${de(s.prioritaet)}`,children:["Priorität ",s.prioritaet]}),e.jsx(x,{className:`${k(s.status)} text-white`,children:C(s.status)})]})]})}),e.jsxs(m,{children:[e.jsx("div",{className:"bg-gray-50 p-3 rounded mb-4",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Maßnahme:"})," ",s.massnahme]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{size:"sm",variant:"outline",children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"Details"]}),s.status!=="behoben"&&e.jsxs(t,{size:"sm",children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})]},s.id))})}),e.jsx(w,{value:"wachen",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:L.map(s=>e.jsxs(n,{className:"hover:shadow-md transition-shadow",children:[e.jsx(D,{className:"pb-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{className:"text-lg",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.telefon})]}),e.jsx(x,{variant:"outline",children:"Eingeteilt"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Schicht"}),e.jsxs("span",{className:"font-medium",children:[new Date(s.schicht_beginn).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})," -",new Date(s.schicht_ende).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(J,{className:"h-4 w-4 text-gray-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.bereich})]}),s.bemerkung&&e.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:s.bemerkung}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]}),e.jsxs(t,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Entfernen"]})]})]})})]},s.id))})}),e.jsx(w,{value:"verwalten",className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alle Checklisten verwalten"}),e.jsxs(t,{variant:"destructive",size:"sm",onClick:ne,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Alle löschen"]})]}),e.jsxs("div",{className:"space-y-3",children:[u.map(s=>e.jsxs(n,{className:"p-4 border border-gray-200 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.titel}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500 mt-1",children:[e.jsxs("span",{children:["ID: ",s.id]}),e.jsx(x,{variant:"outline",className:"text-xs",children:s.typ==="hochwasser"?"Hochwasser":s.typ==="kontrolle"?"Kontrolle":"Übung"}),e.jsx(x,{className:`${k(s.status)} text-white text-xs`,children:C(s.status)}),e.jsxs("span",{children:["Erstellt: ",new Date(s.erstellt_am).toLocaleDateString("de-DE")]})]})]})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("div",{className:"text-gray-600",children:"Fortschritt"}),e.jsxs("div",{className:"font-medium",children:[s.fortschritt,"%"]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsxs(t,{size:"sm",variant:"outline",onClick:()=>p(`/flood-protection/checklist/${s.id}`),children:[e.jsx(j,{className:"h-4 w-4 mr-1"}),"Öffnen"]}),e.jsxs(t,{size:"sm",variant:"outline",onClick:()=>ce(s.id),children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Duplizieren"]}),e.jsxs(t,{size:"sm",variant:"destructive",onClick:()=>re(s.id,s.titel),children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Löschen"]})]})]})]}),s.beginn_pegelstand_cm&&e.jsxs("div",{className:"mt-3 text-sm text-gray-600 bg-blue-50 p-2 rounded",children:["Pegelstand: ",s.beginn_pegelstand_cm," cm"]})]},s.id)),u.length===0&&e.jsx(n,{className:"p-8 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(j,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Keine Checklisten vorhanden"}),e.jsx("p",{className:"text-sm",children:"Erstellen Sie eine neue Checkliste, um zu beginnen."})]})})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800 mb-1",children:"Wichtiger Hinweis"}),e.jsx("p",{className:"text-yellow-700",children:"Das Löschen von Checklisten kann nicht rückgängig gemacht werden. Alle zugehörigen Aufgaben, Prüfungen und Dokumentationen gehen verloren."})]})]})})]})})]})]}),e.jsx(M,{open:se,onOpenChange:y,children:e.jsxs(I,{className:"max-w-md mx-4 max-h-[90vh] overflow-y-auto","aria-describedby":"dialog-description",children:[e.jsxs($,{children:[e.jsx(H,{className:"text-lg",children:"Neue Checkliste erstellen"}),e.jsx("p",{id:"dialog-description",className:"text-sm text-gray-600",children:"Erstellen Sie eine neue Hochwasserschutz-Checkliste mit automatischen Aufgaben"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(l,{htmlFor:"titel",className:"text-sm font-medium",children:["Titel ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"titel",value:f.titel,onChange:s=>b(a=>({...a,titel:s.target.value})),placeholder:"z.B. Hochwasserereignis Juni 2025",className:"mt-1 text-base",required:!0})]}),e.jsxs("div",{children:[e.jsxs(l,{htmlFor:"typ",className:"text-sm font-medium",children:["Typ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(E,{value:f.typ,onValueChange:s=>b(a=>({...a,typ:s})),children:[e.jsx(A,{className:"mt-1",children:e.jsx(T,{placeholder:"Typ auswählen"})}),e.jsxs(z,{children:[e.jsx(o,{value:"hochwasser",children:"Hochwasserereignis"}),e.jsx(o,{value:"uebung",children:"Übung"})]})]})]}),e.jsxs("div",{children:[e.jsxs(l,{htmlFor:"pegelstand",className:"text-sm font-medium",children:["Aktueller Pegelstand (cm) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"pegelstand",type:"number",value:f.pegelstand,onChange:s=>b(a=>({...a,pegelstand:s.target.value})),placeholder:"z.B. 245",className:"mt-1 text-base",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"beschreibung",className:"text-sm font-medium",children:"Beschreibung / Notizen"}),e.jsx(W,{id:"beschreibung",value:f.beschreibung,onChange:s=>b(a=>({...a,beschreibung:s.target.value})),placeholder:"Zusätzliche Informationen zum Ereignis...",rows:3,className:"mt-1 text-base resize-none"})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Automatisch erstellt:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• 11 Standardaufgaben (Beginn + Ende)"}),e.jsx("li",{children:"• Schieber-Prüfungen für alle aktiven Anlagen"}),e.jsx("li",{children:"• Schadensmelde-System"}),e.jsx("li",{children:"• Deichwachen-Verwaltung"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-2",children:[e.jsx(t,{variant:"outline",onClick:()=>y(!1),className:"order-2 sm:order-1",children:"Abbrechen"}),e.jsxs(t,{onClick:le,className:"order-1 sm:order-2",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Checkliste erstellen"}),e.jsx("span",{className:"sm:hidden",children:"Erstellen"})]})]})]})]})})]})}export{es as default};
